falco:
  jsonOutput: true
  logLevel: info

  # On active explicitement la source eBPF
  modern_bpf:
    enabled: true

  # On désactive le syscall_event_source (inutile avec modern_bpf)
  syscall_event_source:
    enabled: false

driver:
  enabled: false  # désactive totalement le falco-driver-loader

# Désactive les plugins si inutiles
plugins:
  - name: json
    library_path: libjson.so
    init_config: ""

customRules:
  custom-sec-rules.yaml: |
    - rule: Suspicious File Created in /etc
      desc: Detects file creation in /etc
      condition: evt.type = creat and fd.name startswith /etc
      output: >
        File created in /etc (user=%user.name file=%fd.name command=%proc.cmdline)
      priority: WARNING
      tags: [filesystem, etc]
